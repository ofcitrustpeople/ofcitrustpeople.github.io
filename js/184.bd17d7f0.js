"use strict";(self["webpackChunkvue_3_authentication_jwt"]=self["webpackChunkvue_3_authentication_jwt"]||[]).push([[184],{184:function(t,e,s){s.r(e),s.d(e,{default:function(){return L}});var a=s(3396),l=s(7139);const i=t=>((0,a.dD)("data-v-73d08f45"),t=t(),(0,a.Cn)(),t),o={class:"col col-xs-9 col-lg-12 mt-4 offset-md-1"},r={class:"col col-10 align-self-end"},d={key:0,class:"table"},n=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),c=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),h=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),u=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),_=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),g=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),b=[n,c,h,u,_,g],k={key:1},y={class:"d-flex"},p={class:"table",id:"table_group"},w=i((()=>(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Группа")])],-1))),v=["onClick"],m={key:0,class:"table skelet"},j=i((()=>(0,a._)("tr",null,null,-1))),D=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),f=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),A=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),W=[D,f,A],C={key:1,class:"table table-sm",id:"table_subject"},E=i((()=>(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Предмет")])],-1))),Z=["onClick"],T={key:2,class:"table skelet"},H=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),K=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),S=i((()=>(0,a._)("td",null,[(0,a._)("div",{class:"skeleton skeleton-animate"})],-1))),Y=[H,K,S],R={key:3,class:"table table-sm",id:"table_teacher"},z=i((()=>(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Преподаватель")])],-1))),G=["onClick"];function I(t,e,s,i,n,c){return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",r,[n.loading?((0,a.wg)(),(0,a.iD)("table",d,[(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.subjects,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t},b)))),128))])])):((0,a.wg)(),(0,a.iD)("div",k,[(0,a._)("div",y,[(0,a._)("table",p,[w,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.groups,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.group_id},[(0,a._)("th",{onClick:e=>{this.selected_group=t.group_id,c.findWl(t.group_id)},class:(0,l.C_)({"table-active":this.selected_group==t.group_id})},(0,l.zw)(t.group_number),11,v)])))),128))])]),n.s_loading?((0,a.wg)(),(0,a.iD)("table",m,[(0,a._)("tbody",null,[j,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.subjects,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t},W)))),128))])])):this.selected_group>=0?((0,a.wg)(),(0,a.iD)("table",C,[E,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.subjects,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.subject_id},[(0,a._)("th",{onClick:e=>{this.selected_subject=t.subject_id,this.loadTeachersData(t.subject_id),this.t_loading=!0},class:(0,l.C_)({"table-active":this.selected_subject==t.subject_id,"text-success bold":-1!=this.findWl(this.selected_group,t.subject_id)})},(0,l.zw)(t.subject_name),11,Z)])))),128))])])):(0,a.kq)("",!0),n.t_loading?((0,a.wg)(),(0,a.iD)("table",T,[(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.subjects,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t},Y)))),128))])])):this.selected_subject>=0?((0,a.wg)(),(0,a.iD)("table",R,[z,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.teachers,((t,e)=>((0,a.wg)(),(0,a.iD)("tr",{key:t.teacher_id},[(0,a._)("th",{onClick:e=>{this.selected_teacher=t.teacher_id},class:(0,l.C_)({"table-active":this.selected_teacher==t.teacher_id,"table-success":this.findWl(this.selected_group,this.selected_subject)==t.teacher_id})},(0,l.zw)(t.last_name)+" "+(0,l.zw)(this.teacher_load[e].length)+" ",11,G)])))),128))])])):(0,a.kq)("",!0)]),(0,a._)("div",null,[(0,a._)("button",{class:"btn btn-primary btn-block",onClick:e[0]||(e[0]=(...t)=>c.saveRel&&c.saveRel(...t))},"Сохранить связь")])]))])])}s(7658);var $=s(5124),q={data(){return{groups:[],subjects:[],teachers:[],employment:[],wl:[],rels:[],teacher_load:[],selected_group:-1,selected_subject:-1,selected_teacher:-1,saved_num:-1,saved_group:0,saved_subject:0,saved_teacher:0,saved:!1,t_loading:!0,s_loading:!0,wl_loading:!0,loading:!0,searchQuery:""}},methods:{async loadGroupsData(){try{const t=await $.Z.getAllGroups();this.groups=Array.isArray(t.data)?t.data:[t.data],this.loading=!1}catch(t){console.error("Error loading groups data:",t)}},async loadTeachersData(t){try{const e=await $.Z.getTeachersForSubject(t);this.teachers=Array.isArray(e.data)?e.data:[e.data],this.loadTeacherLoad(this.teachers),this.s_loading=!1}catch(e){console.error("Error loading teachers data:",e)}},async loadSubjectsData(){try{const t=await $.Z.getAllSubjects();this.subjects=Array.isArray(t.data)?t.data:[t.data],this.loading=!1}catch(t){console.error("Error loading subjects data:",t)}},async loadEmploymentData(){try{const t=await $.Z.getAllEmployments();this.employment=Array.isArray(t.data)?t.data:[t.data],this.loading=!1}catch(t){console.error("Error loading employments data:",t)}},async loadWorkloads(){try{const t=await $.Z.getAllWorkloads();this.wl=Array.isArray(t.data)?t.data:[t.data],this.wl_loading=!1}catch(t){console.error("Error loading employments data:",t)}},async loadTeacherLoad(t){try{var e=[];for(let a=0;a<t.length;a++){const l=t[a],i=await $.Z.getSubjectsForTeacher(l.teacher_id);var s=Array.isArray(i.data)?i.data:[i.data];"Пустой вывод."==s?e.push([]):e.push(s)}this.teacher_load=e,this.loading=!1,this.t_loading=!1}catch(a){console.error("Error loading employments data:",a)}},saveRel(){if(-1==this.findWl(this.selected_group,this.selected_subject))$.Z.addWorkload(this.selected_group,this.selected_subject,this.selected_teacher);else{if(this.findWl(this.selected_group,this.selected_subject)==this.selected_teacher)return void console.log(123);$.Z.editWorkload(this.findWlID(this.selected_group,this.selected_subject),this.selected_teacher)}this.loadTeachersData(this.selected_subject);while(1==this.loading&&1==this.wl_loading)this.findWl(this.selected_group,this.selected_subject);this.saved=!0},viewGroupDetail(t){this.$router.push(`/groups/${t}`)},viewRightsDetail(){this.$router.push("/Rights/groups")},contains(t,e){var s;for(s in e)if(e[s]===t)return!0;return!1},teachersForSub(t){var e=[];return this.employment.forEach((function(s){t==s.subject_id&&e.push(s)})),e},findWl(t,e){var s;for(s in this.wl)if(this.wl[s].group_id==t&&this.wl[s].subject_id==e)return this.wl[s].teacher_id;return this.s_loading=!1,-1},findWlID(t,e){var s;for(s in this.wl)if(this.wl[s].group_id==t&&this.wl[s].subject_id==e)return this.wl[s].wl_id;return this.s_loading=!1,-1},loadData(){this.loadGroupsData(),this.loadSubjectsData(),this.loadEmploymentData(),this.loadWorkloads()}},created(){const t=this.$route.query;this.currentPage=parseInt(t.page)||1,this.searchQuery=t.search||"",this.loadData()}},x=s(89);const F=(0,x.Z)(q,[["render",I],["__scopeId","data-v-73d08f45"]]);var L=F}}]);
//# sourceMappingURL=184.bd17d7f0.js.map